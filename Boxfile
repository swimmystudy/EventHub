web1:
  document_root: /public_html
  shared_writable_dirs:
    - cakephp/EventHub/tmp
    - cakephp/EventHub/tmp/cache
    - cakephp/EventHub/tmp/cache/models
    - cakephp/EventHub/tmp/cache/persistent
    - cakephp/EventHub/tmp/cache/views
    - cakephp/EventHub/tmp/logs
    - cakephp/EventHub/tmp/sessions
    - cakephp/EventHub/tmp/tests
  php_extensions:
    - mcrypt
    - mbstring
    - pdo_mysql
    - apc
  after_build:
    - "if [ ! -f composer.phar ]; then curl -s http://getcomposer.org/installer | php; fi; php composer.phar install"
    - "mv cakephp/EventHub/Config/database.php.pagoda cakephp/EventHub/Config/database.php"
  before_deploy:
    # https://github.com/CakeDC/migrations
    - "cakephp/EventHub/Console/cake Migrations.migration all"
  after_deploy:
    - "rm -rf cakephp/EventHub/tmp/cache/models/*"
    - "rm -rf cakephp/EventHub/tmp/cache/persistent/*"
    - "rm -rf cakephp/EventHub/tmp/cache/views/*"
  # Stop Content-Length header from being set, by default the value is incorrect
  php_zlib_output_compression: On
 
db1:
  type: mysql